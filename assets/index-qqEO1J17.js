import{createRoot as P}from"react-dom/client";import p,{useState as g,useEffect as R,useRef as M,useCallback as O}from"react";import{Link as x,useParams as A,createBrowserRouter as I,RouterProvider as L}from"react-router-dom";import{TailSpin as S}from"react-loader-spinner";import f from"axios";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function c(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(t){if(t.ep)return;t.ep=!0;const n=c(t);fetch(t.href,n)}})();const T=()=>React.createElement("nav",{className:"text-center text-black text-[1.5em]"},React.createElement("h1",{className:"text-silver"},"OMDB Search")),$=a=>{const{queryValue:e,page:c}=a,[r,t]=g(""),n=s=>{const{value:o}=s.target;o&&o.length>0?(t(o),e(o),c(1)):(t(""),e(""),c(1))};return React.createElement("div",{className:"grid justify-center items-center"},React.createElement("input",{type:"search",placeholder:"Enter your movie name",onChange:n,value:r,"data-testid":"search-input",className:"border-2 border-pink-300 m-4 p-4 rounded focus:outline-none focus:border-pink-500 transition"}))},y="b9bd48a6",N="https://www.omdbapi.com/?apikey=",k="https://picsum.photos/200/300",G=a=>{const e=r=>p.createElement("div",{className:"text-center text-white bg-gray-600 m-4 p-4 rounded shadow"},p.createElement(x,{to:`/${r.imdbID}`,className:"text-white hover:underline"},p.createElement("h3",{className:"font-bold text-lg mb-2"},r.Title),p.createElement("img",{src:r.Poster!=="N/A"?r.Poster:k,alt:"poster",width:"300",height:"400",className:"mx-auto mb-2 object-cover rounded"}),p.createElement("p",null,p.createElement("span",{className:"text-xl font-semibold"},r.Year)))),c=a.poster.filter((r,t,n)=>t===n.findIndex(s=>s.imdbID===r.imdbID));return c.length>0?p.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 justify-between"},c.map((r,t)=>c.length===t+1?p.createElement("div",{"data-testid":"movie-item",key:r.imdbID,ref:a.letRef,className:"flex"},e(r)):p.createElement("div",{"data-testid":"movie-item",key:r.imdbID,className:"flex"},e(r)))):null},w=()=>React.createElement("div",{className:"flex justify-center items-center min-h-screen"},React.createElement(S,{height:80,width:80,color:"grey",ariaLabel:"loading"}));function j(a,e){const[c,r]=g(!0),[t,n]=g(!1),[s,o]=g([]),[i,E]=g(!1);return R(()=>{o([]),r(!1)},[a]),R(()=>{r(!0),n(!1);let b;return f({method:"GET",url:`${N}${y}&s=${a}&type=movie`,params:{q:a,page:e},cancelToken:new f.CancelToken(m=>b=m)}).then(m=>{o(m.data.Search.filter((u,l)=>m.data.Search.indexOf(u)===l)),E(m.data.totalResults.length>0),r(!1)}).catch(m=>{f.isCancel(m)||(r(!1),n(!0))}),()=>b()},[a,e]),{loading:c,error:t,movies:s,hasMore:i}}const h=()=>{const[a,e]=g(""),[c,r]=g(1),{movies:t,hasMore:n,loading:s,error:o}=j(a,c),i=M(),E=O(u=>{s||(i.current&&i.current.disconnect(),i.current=new IntersectionObserver(l=>{l[0].isIntersecting&&n&&!o&&r(d=>d+1)}),u&&i.current.observe(u))},[s,n,o]),b=u=>{e(u)},m=u=>{r(u)};return React.createElement(React.Fragment,null,React.createElement(T,null),React.createElement($,{queryValue:b,page:m}),s?React.createElement(w,null):null,t.length>0?React.createElement(G,{letRef:E,poster:t}):null)},B=async a=>{let e=f({method:a.method?a.method:{},url:a.url?a.url:{}}).then(c=>e=c).catch(c=>e=c);return e},C=()=>{var n,s,o,i,E,b,m,u;const{id:a}=A(),[e,c]=g([]),[r,t]=g(!1);return R(()=>{async function l(){t(!0);let d=await B({method:"GET",url:`${N}${y}&i=${a}`});t(!1),(d==null?void 0:d.data.Response)==="True"&&Object.keys(d==null?void 0:d.data).length>0&&c(d==null?void 0:d.data)}l()},[a]),!r&&e&&Object.keys(e).length>0?React.createElement("div",{"data-testid":"details"},React.createElement("div",{className:"block m-8 text-center"},React.createElement(x,{to:"/",className:"text-blue-600 hover:underline text-lg font-bold"},"Home"),React.createElement("h1",{className:"text-center text-[2rem] text-silver font-bold mt-4 mb-8"},e==null?void 0:e.Title)),React.createElement("div",{className:"block m-8 text-center"},React.createElement("img",{src:(e==null?void 0:e.Poster)!=="N/A"?e==null?void 0:e.Poster:k,alt:"Poster",className:"mx-auto bg-black border border-black rounded-lg w-[300px] max-w-full sm:w-[175px]"})),React.createElement("div",{className:"block m-8 text-center"},React.createElement("p",null,React.createElement("strong",null,"Year:")," ",React.createElement("span",{className:"inline-block bg-gray-300 text-black px-4 py-2 rounded-2xl m-2"},e==null?void 0:e.Year)),React.createElement("p",null,React.createElement("strong",null,"Rated:")," ",React.createElement("span",{className:"inline-block bg-gray-300 text-black px-4 py-2 rounded-2xl m-2"},e==null?void 0:e.Rated)),React.createElement("p",null,React.createElement("strong",null,"Genre:")," ",((n=e==null?void 0:e.Genre)==null?void 0:n.split(",").length)>0?(s=e==null?void 0:e.Genre)==null?void 0:s.split(",").map(l=>React.createElement("span",{key:l,className:"inline-block bg-gray-300 text-black px-4 py-2 rounded-2xl m-2"},l)):React.createElement("span",{className:"inline-block bg-gray-300 text-black px-4 py-2 rounded-2xl m-2"},e==null?void 0:e.Genre)),React.createElement("p",null,React.createElement("strong",null,"Plot:")," ",e==null?void 0:e.Plot),React.createElement("p",null,React.createElement("strong",null,"Actors:")," ",((o=e==null?void 0:e.Actors)==null?void 0:o.split(",").length)>0?(i=e==null?void 0:e.Actors)==null?void 0:i.split(",").map(l=>React.createElement("span",{key:l,className:"inline-block bg-gray-300 text-black px-4 py-2 rounded-2xl m-2"},l)):React.createElement("span",{className:"inline-block bg-gray-300 text-black px-4 py-2 rounded-2xl m-2"},e==null?void 0:e.Actors)),React.createElement("p",null,React.createElement("strong",null,"Director/ Directors:")," ",((E=e==null?void 0:e.Director)==null?void 0:E.split(",").length)>0?(b=e==null?void 0:e.Director)==null?void 0:b.split(",").map(l=>React.createElement("span",{key:l,className:"inline-block bg-gray-300 text-black px-4 py-2 rounded-2xl m-2"},l)):React.createElement("span",{className:"inline-block bg-gray-300 text-black px-4 py-2 rounded-2xl m-2"},e==null?void 0:e.Director)),React.createElement("p",null,React.createElement("strong",null,"Writer/ Writers:")," ",((m=e==null?void 0:e.Writer)==null?void 0:m.split(",").length)>0?(u=e==null?void 0:e.Writer)==null?void 0:u.split(",").map(l=>React.createElement("span",{key:l,className:"inline-block bg-gray-300 text-black px-4 py-2 rounded-2xl m-2"},l)):React.createElement("span",{className:"inline-block bg-gray-300 text-black px-4 py-2 rounded-2xl m-2"},e==null?void 0:e.Writer)),React.createElement("p",null,React.createElement("strong",null,"Awards: ",React.createElement("span",{className:"inline-block bg-gray-300 text-black px-4 py-2 rounded-2xl m-2"},e==null?void 0:e.Awards))),React.createElement("p",null,React.createElement("strong",null,"OMDB Rating:"),React.createElement("span",{className:"inline-block bg-gray-300 text-black px-4 py-2 rounded-2xl m-2"},React.createElement("meter",{id:"rating",min:"",low:3,high:9,max:10,value:e==null?void 0:e.imdbRating})," ",`${e==null?void 0:e.imdbRating}`)))):React.createElement(w,null)},_=()=>React.createElement("h3",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 m-auto text-center"},"Oops Page Not Found!..."),F=I([{path:"/",element:React.createElement(h,null)},{path:"/:id",element:React.createElement(C,null)},{path:"/OMDB_Movie_Search",element:React.createElement(h,null)},{path:"*",element:React.createElement(_,null)}]);function V(){return React.createElement(L,{router:F,future:{v7_startTransition:!0}})}P(document.getElementById("root")).render(React.createElement(V,null));
